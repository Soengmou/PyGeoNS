#!/usr/bin/env python
import argparse
import json
import sys
import logging
from pygeons import *

p = argparse.ArgumentParser(
  usage='%(prog)s STR STR [options]',
  formatter_class=argparse.RawDescriptionHelpFormatter,
  description=
'''Runs the PyGeoNS Interactive Strain Viewer. This function takes two
data files, which specify the deformation gradients, as arguments. 
'''
)

p.add_argument('xdiff_file',**GLOSSARY['xdiff_file'])
p.add_argument('ydiff_file',**GLOSSARY['ydiff_file'])
p.add_argument('-v','--verbose',**GLOSSARY['verbose'])
p.add_argument('--scale',**GLOSSARY['scale'])
p.add_argument('--key_magnitude',**GLOSSARY['key_magnitude'])
p.add_argument('--key_position',**GLOSSARY['key_position'])
p.add_argument('--compression_color',**GLOSSARY['compression_color'])
p.add_argument('--extension_color',**GLOSSARY['extension_color'])
p.add_argument('--vertices',**GLOSSARY['vertices'])
p.add_argument('--alpha',**GLOSSARY['alpha'])
p.add_argument('--snr_mask',**GLOSSARY['snr_mask'])
p.add_argument('--ts_title',**GLOSSARY['ts_title'])
p.add_argument('--map_resolution',**GLOSSARY['map_resolution'])
p.add_argument('--map_title',**GLOSSARY['map_title'])
p.add_argument('--map_xlim',**GLOSSARY['map_xlim'])
p.add_argument('--map_ylim',**GLOSSARY['map_ylim'])
p.add_argument('--fontsize',**GLOSSARY['fontsize'])
p.add_argument('--break_lons',**GLOSSARY['break_lons'])
p.add_argument('--break_lats',**GLOSSARY['break_lats'])
p.add_argument('--break_conn',**GLOSSARY['break_conn'])
p = vars(p.parse_args())

verbose = p.pop('verbose')
logging.basicConfig(level=30-10*verbose)
xdiff_file = p.pop('xdiff_file')
xdiff_dict = dict_from_hdf5(xdiff_file)
ydiff_file = p.pop('ydiff_file')
ydiff_dict = dict_from_hdf5(ydiff_file)

# throw out any Nones and let the lower level functions determine the defaults
for k in p.keys(): 
  if p[k] is None: 
    p.pop(k)

pygeons_strain(xdiff_dict,ydiff_dict,**p)
